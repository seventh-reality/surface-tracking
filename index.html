<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AR.js with SLAM for iOS & Android</title>
  
  <!-- Include AR.js for WebAR -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://unpkg.com/ar.js@3.3.2/aframe/build/aframe-ar.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <style>
    body, html {
      margin: 0;
      overflow: hidden;
      width: 100%;
      height: 100%;
    }
    #rotate-btn, #scale-btn {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      background-color: #000;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      margin: 5px;
    }
    #scale-btn {
      left: 60%;
    }
  </style>
</head>
<body>

  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://unpkg.com/ar.js@3.3.2/aframe/build/aframe-ar.min.js"></script>

  <script>
    // Initialize AR.js with Three.js
    const scene = new THREE.Scene();
    const camera = new THREE.Camera();
    const renderer = new THREE.WebGLRenderer({ alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Create a 3D model loader
    const loader = new THREE.GLTFLoader();
    let model;

    // Load the GLTF model
    loader.load('9mb.glb', (gltf) => {
      model = gltf.scene;
      model.position.set(0, 0, -5); // Set initial position
      model.scale.set(0.5, 0.5, 0.5); // Set initial scale
      scene.add(model);
    });

    // Handle window resize
    window.addEventListener('resize', () => {
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    // Animation loop
    const animate = () => {
      requestAnimationFrame(animate);
      renderer.render(scene, camera);
    };

    // Start the animation loop
    animate();

    // Handle SLAM surface tracking
    const hitTest = (event) => {
      const hit = event.detail.intersectedEl;
      if (hit) {
        const { x, y, z } = hit.getAttribute('position');
        model.position.set(x, y, z);
      }
    };

    document.querySelector('a-scene').addEventListener('ar-hit-test-select', hitTest);
  </script>

  <!-- Rotate and Scale Buttons -->
  <button id="rotate-btn">Rotate Model</button>
  <button id="scale-btn">Scale Model</button>

  <script>
    const rotateButton = document.getElementById('rotate-btn');
    let currentRotation = 0;

    rotateButton.addEventListener('click', function () {
      currentRotation += 45; // Rotate by 45 degrees on each click
      if (model) {
        model.rotation.y = THREE.MathUtils.degToRad(currentRotation);
      }
    });

    const scaleButton = document.getElementById('scale-btn');
    let currentScale = 0.5;

    scaleButton.addEventListener('click', function () {
      currentScale += 0.1; // Increase scale by 0.1 on each click
      if (model) {
        model.scale.set(currentScale, currentScale, currentScale);
      }
    });
  </script>

</body>
</html>
